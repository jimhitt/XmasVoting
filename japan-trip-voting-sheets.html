<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Japan Trip Activity Voting</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .voter-select {
            margin-bottom: 30px;
        }

        .voter-select label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #333;
            font-size: 1.1em;
        }

        .voter-select select {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            border: 2px solid #667eea;
            border-radius: 10px;
            background: white;
            cursor: pointer;
        }

        .activity {
            margin-bottom: 40px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            transition: transform 0.2s;
        }

        .activity:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .activity-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .activity-name {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
            flex-grow: 1;
        }

        .emoji-display {
            font-size: 3em;
            min-width: 60px;
            text-align: center;
        }

        .slider-container {
            margin: 20px 0;
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: linear-gradient(to right, #ff4444, #ffaa44, #44ff44);
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: white;
            border: 3px solid #667eea;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .slider::-moz-range-thumb {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: white;
            border: 3px solid #667eea;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.9em;
            color: #666;
        }

        .slider-labels span {
            max-width: 30%;
            text-align: center;
        }

        .slider-labels .left { text-align: left; }
        .slider-labels .right { text-align: right; }

        .buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        button {
            flex: 1;
            padding: 15px;
            font-size: 1.1em;
            font-weight: bold;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .submit-btn {
            background: #667eea;
            color: white;
        }

        .submit-btn:hover:not(:disabled) {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .view-results-btn {
            background: #764ba2;
            color: white;
        }

        .view-results-btn:hover:not(:disabled) {
            background: #63408a;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(118, 75, 162, 0.4);
        }

        .results-container {
            display: none;
        }

        .results-container.active {
            display: block;
        }

        .result-item {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .result-item h3 {
            margin-bottom: 15px;
            color: #333;
        }

        .vote-bar {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            gap: 10px;
        }

        .vote-name {
            width: 100px;
            font-weight: bold;
            color: #666;
        }

        .vote-visual {
            flex-grow: 1;
            height: 30px;
            background: #e0e0e0;
            border-radius: 5px;
            position: relative;
            overflow: hidden;
        }

        .vote-fill {
            height: 100%;
            border-radius: 5px;
            transition: width 0.5s;
        }

        .vote-emoji {
            font-size: 1.5em;
        }

        .vote-score {
            font-size: 0.9em;
            color: #666;
            min-width: 30px;
        }

        .message {
            padding: 15px;
            margin: 20px 0;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
        }

        .success {
            background: #d4edda;
            color: #155724;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
        }

        .warning {
            background: #fff3cd;
            color: #856404;
        }

        .info {
            background: #d1ecf1;
            color: #0c5460;
        }

        .back-btn {
            background: #6c757d;
            color: white;
            margin-bottom: 20px;
        }

        .back-btn:hover {
            background: #5a6268;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: #667eea;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .average-score {
            text-align: right;
            color: #667eea;
            font-weight: bold;
            margin-top: 10px;
        }

        .category-header {
            font-size: 1.8em;
            font-weight: bold;
            color: #667eea;
            margin: 40px 0 20px 0;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        .category-header:first-of-type {
            margin-top: 10px;
        }

        .activity-description {
            color: #555;
            line-height: 1.6;
            margin: 15px 0;
            font-size: 0.95em;
        }

        .activity-details {
            margin: 10px 0;
        }

        .detail-row {
            margin: 8px 0;
            font-size: 0.9em;
        }

        .detail-label {
            font-weight: bold;
            color: #667eea;
            display: inline-block;
            min-width: 100px;
        }

        .pros-cons {
            margin: 15px 0;
            padding: 12px;
            background: white;
            border-radius: 8px;
        }

        .pros-cons .pro {
            color: #28a745;
            margin: 8px 0;
        }

        .pros-cons .con {
            color: #dc3545;
            margin: 8px 0;
        }

        .pros-cons .pro::before {
            content: "‚úÖ ";
            font-weight: bold;
        }

        .pros-cons .con::before {
            content: "‚ö†Ô∏è ";
            font-weight: bold;
        }

        .pros-cons .label {
            font-weight: bold;
        }

        .sheet-link {
            text-align: center;
            margin-top: 20px;
        }

        .sheet-link a {
            color: #667eea;
            text-decoration: none;
            font-weight: bold;
        }

        .sheet-link a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="votingView">
            <h1>üóæ Japan Trip Voting</h1>
            <p class="subtitle">Vote on side trips (overnight stays) and day trips from Tokyo!</p>

            <div class="voter-select">
                <label for="voterName">Who's voting?</label>
                <select id="voterName" onchange="checkExistingVote()">
                    <option value="">Select your name...</option>
                    <option value="Jim">Jim</option>
                    <option value="Meg">Meg</option>
                    <option value="James">James</option>
                    <option value="Andrew">Andrew</option>
                </select>
            </div>

            <div id="activities"></div>

            <div id="message"></div>
            <div id="loading" class="loading">
                <div class="spinner"></div>
                <p>Submitting your votes...</p>
            </div>

            <div class="buttons">
                <button class="submit-btn" onclick="submitVote()" id="submitBtn">Submit My Votes</button>
                <button class="view-results-btn" onclick="showResults()" id="resultsBtn">View Results</button>
            </div>
        </div>

        <div id="resultsView" class="results-container">
            <button class="back-btn" onclick="showVoting()">‚Üê Back to Voting</button>
            <h1>üìä Voting Results</h1>
            <div id="loadingResults" class="loading">
                <div class="spinner"></div>
                <p>Loading results...</p>
            </div>
            <div id="results"></div>
            <div class="sheet-link">
                <a href="https://docs.google.com/spreadsheets/d/1eCdSEBU8iy30yQebeT0lAsQw6zGiIkVuuNmPPgaAT0w/edit?usp=sharing" target="_blank">üìä View Full Spreadsheet</a>
            </div>
        </div>
    </div>

    <script>
        // IMPORTANT: Replace this with your Google Apps Script web app URL
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby4IFq0KJUdN-ccb56zAbG4fPrhrpE-7UrcEUtZn2aXixr2-TULiyyJJkFhUyvW2fg/exec';
        
        const activities = [
            // Side Trips (Overnight Stay)
            {
                id: 'skiing',
                name: 'The Winter Adventure (Shiga Kogen Skiing)',
                category: 'Side Trip',
                description: 'A high-energy trip to Japan\'s largest interconnected ski area. You\'ll stay at the Okushiga Kogen Hotel, which offers "ski-in/ski-out" convenience. While it\'s focused on the outdoors, the region is famous for the Snow Monkeys (Jigokudani), which look like real-life Pok√©mon, and the nearby historic towns offer a "hidden mountain village" vibe straight out of a fantasy anime.',
                pros: 'World-class powder snow; the "cool factor" of skiing in the Japanese Alps; visiting the iconic Snow Monkeys.',
                cons: 'Most travel-intensive (4.5 hours each way); weather dependent; less focused on specific Samurai/Anime history.',
                emojis: ['üò±', 'üòê', 'üòä', 'ü§©', '‚õ∑Ô∏è']
            },
            {
                id: 'kyoto',
                name: 'The Warrior\'s Path (Kyoto)',
                category: 'Side Trip',
                description: 'The ultimate cultural deep-dive. Kyoto is the heart of Samurai history and the inspiration for countless anime like Demon Slayer and Samurai Champloo. You can visit a Samurai & Ninja Museum to try on armor and throw shuriken, or explore the Toei Kyoto Studio Park, an active film set where you can walk through a real-life Edo-period village and watch ninja shows.',
                pros: 'Incredible interactive Samurai experiences; home to the Kyoto International Manga Museum; the Fushimi Inari shrines feel like a Demon Slayer training ground.',
                cons: 'Can be very crowded; requires moving between many different sites; potentially "temple fatigue" if not balanced with enough action.',
                emojis: ['üò±', 'üòê', 'üòä', 'ü§©', '‚õ©Ô∏è']
            },
            {
                id: 'kanazawa',
                name: 'The Hidden Fortress (Kanazawa)',
                category: 'Side Trip',
                description: 'Often called "Little Kyoto," this city is famous for its perfectly preserved Samurai District (Nagamachi) and a "Ninja Temple" (Myoryuji) filled with trapdoors and secret passages. It\'s less crowded than Kyoto and feels like a boutique adventure. The modern side includes the Pok√©mon Center Kanazawa (with exclusive local merchandise) and one of the world\'s most interactive contemporary art museums.',
                pros: 'Best preserved Samurai residences you can actually enter; very easy to navigate; direct 2.5-hour bullet train from Tokyo; unique Pok√©mon Center.',
                cons: 'Smaller than Kyoto with fewer total "big name" attractions; no skiing/snow activities in the city itself.',
                emojis: ['üò±', 'üòê', 'üòä', 'ü§©', '‚öîÔ∏è']
            },
            // Day Trips from Tokyo
            {
                id: 'hakone',
                name: 'Hakone: Mountains, Crater Lakes, and Pirate Ships',
                category: 'Day Trip',
                description: 'A scenic journey through Fuji-Hakone-Izu National Park using a famous "loop" of diverse transportation, including a mountain railway, a cable car (ropeway) over volcanic vents, and a cruise across Lake Ashi.',
                travelTime: '~90 to 120 minutes',
                travelMode: 'Take the Odakyu Line from Shinjuku to Hakone-Yumoto Station. For the fastest and most comfortable journey, book the "Romancecar" limited express.',
                pros: 'Offers iconic views of Mount Fuji (weather permitting) and the unique experience of a "Pirate Ship" cruise. The Hakone Open-Air Museum is world-class and specifically designed with interactive art installations that children can climb on.',
                cons: 'The itinerary is highly weather-dependent; if it is cloudy, you will miss the mountain views. It is one of the most popular trips from Tokyo, so transit lines can be long on weekends.',
                emojis: ['üò±', 'üòê', 'üòä', 'ü§©', 'üóª']
            },
            {
                id: 'nikko',
                name: 'Nikko: Shogunate History and Ninja Culture',
                category: 'Day Trip',
                description: 'A trip into the mountains north of Tokyo to visit the lavishly decorated Toshogu Shrine (a UNESCO World Heritage site) followed by a visit to a historical theme park.',
                travelTime: '~120 to 140 minutes',
                travelMode: 'Take the JR Yamanote Line to Shinjuku or Ikebukuro, then transfer to the JR-Tobu "Nikko" Limited Express which goes directly to Tobu-Nikko Station.',
                pros: 'Provides a deep look at Japan\'s samurai history with architecture unlike anything else in the country. Edo Wonderland allows the family to dress in period costume and participate in "Ninja training," making history highly engaging for children.',
                cons: 'Requires a longer travel time. The shrine area involves significant walking on uneven stone paths and many stairs, which may be tiring for younger travelers.',
                emojis: ['üò±', 'üòê', 'üòä', 'ü§©', 'ü•∑']
            },
            {
                id: 'kamakura',
                name: 'Kamakura: Coastal Temples and Giant Buddha',
                category: 'Day Trip',
                description: 'Often called the "Kyoto of the East," this seaside town is home to massive bronze statues, Zen temples, and sandy beaches, all accessible via a charming vintage tram line (the Enoden).',
                travelTime: '~55 to 70 minutes',
                travelMode: 'Take the JR Shonan-Shinjuku Line directly from Shibuya Station to Kamakura Station.',
                pros: 'The "Great Buddha" is an awe-inspiring sight that allows visitors to step inside the statue. The pace is significantly more relaxed than Tokyo, and the proximity to the beach provides a great space for children to play and decompress.',
                cons: 'The main historical streets are narrow and can feel very congested. Many of the most beautiful temples are tucked away on hillsides, requiring a fair amount of uphill walking.',
                emojis: ['üò±', 'üòê', 'üòä', 'ü§©', 'üèñÔ∏è']
            },
            {
                id: 'yokohama',
                name: 'Yokohama: Modern Waterfront and Interactive Museums',
                category: 'Day Trip',
                description: 'A short trip to Japan\'s second-largest city, focusing on the futuristic Minato Mirai harbor district, which is famous for its interactive museums and giant Ferris wheel.',
                travelTime: '~30 minutes',
                travelMode: 'Take the Tokyu Toyoko Line (Express or Limited Express) directly from Shibuya Station to Minatomirai Station.',
                pros: 'Extremely convenient and stroller-friendly. The Cup Noodles Museum (where you design your own ramen) and the Yokohama Cosmo World amusement park provide high-energy, hands-on fun that is a guaranteed hit with kids.',
                cons: 'It lacks the "Old Japan" atmosphere found in the other locations. Much of the architecture and vibe is ultra-modern, which may feel similar to parts of Tokyo you have already explored.',
                emojis: ['üò±', 'üòê', 'üòä', 'ü§©', 'üé°']
            }
        ];

        const labels = [
            "You couldn't pay me enough",
            "Meh",
            "We have to do that or I will rage"
        ];

        function initActivities() {
            const container = document.getElementById('activities');
            container.innerHTML = '';

            let currentCategory = '';

            activities.forEach(activity => {
                // Add category header if it's a new category
                if (activity.category !== currentCategory) {
                    currentCategory = activity.category;
                    const categoryHeader = document.createElement('div');
                    categoryHeader.className = 'category-header';
                    categoryHeader.textContent = currentCategory === 'Side Trip' ?
                        'üè® Side Trips (Overnight Stay)' :
                        'üöÜ Day Trips from Tokyo';
                    container.appendChild(categoryHeader);
                }

                const div = document.createElement('div');
                div.className = 'activity';

                let detailsHTML = '';
                if (activity.travelTime) {
                    detailsHTML = `
                        <div class="activity-details">
                            <div class="detail-row">
                                <span class="detail-label">Travel Time:</span> ${activity.travelTime}
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">How to Get There:</span> ${activity.travelMode}
                            </div>
                        </div>
                    `;
                }

                div.innerHTML = `
                    <div class="activity-header">
                        <div class="activity-name">${activity.name}</div>
                        <div class="emoji-display" id="emoji-${activity.id}">üòê</div>
                    </div>
                    <div class="activity-description">${activity.description}</div>
                    ${detailsHTML}
                    <div class="pros-cons">
                        <div class="pro"><span class="label">Pros:</span> ${activity.pros}</div>
                        <div class="con"><span class="label">Cons:</span> ${activity.cons}</div>
                    </div>
                    <div class="slider-container">
                        <input type="range" min="0" max="100" value="50"
                               class="slider" id="slider-${activity.id}"
                               oninput="updateEmoji('${activity.id}', this.value)">
                        <div class="slider-labels">
                            <span class="left">${labels[0]}</span>
                            <span>${labels[1]}</span>
                            <span class="right">${labels[2]}</span>
                        </div>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function updateEmoji(activityId, value) {
            const activity = activities.find(a => a.id === activityId);
            const emojiDisplay = document.getElementById(`emoji-${activityId}`);
            
            const index = Math.floor((value / 100) * (activity.emojis.length - 1));
            emojiDisplay.textContent = activity.emojis[index];
        }

        function checkExistingVote() {
            const voterName = document.getElementById('voterName').value;
            if (!voterName) return;

            // Check localStorage for previous vote
            const savedVotes = JSON.parse(localStorage.getItem('myVote_' + voterName) || 'null');
            if (savedVotes) {
                showMessage(`Loading your previous votes, ${voterName}!`, 'info');
                activities.forEach(activity => {
                    const slider = document.getElementById(`slider-${activity.id}`);
                    if (savedVotes[activity.id] !== undefined) {
                        slider.value = savedVotes[activity.id];
                        updateEmoji(activity.id, savedVotes[activity.id]);
                    }
                });
            }
        }

        async function submitVote() {
            const voterName = document.getElementById('voterName').value;
            
            if (!voterName) {
                showMessage('Please select your name first!', 'warning');
                return;
            }

            // Validate script URL
            if (SCRIPT_URL === 'YOUR_GOOGLE_SCRIPT_URL_HERE') {
                showMessage('Error: Google Apps Script URL not configured. Please update SCRIPT_URL in the code.', 'error');
                return;
            }

            const votes = {};
            activities.forEach(activity => {
                const slider = document.getElementById(`slider-${activity.id}`);
                votes[activity.id] = parseInt(slider.value);
            });

            // Save to localStorage as backup
            localStorage.setItem('myVote_' + voterName, JSON.stringify(votes));

            // Show loading
            document.getElementById('loading').classList.add('active');
            document.getElementById('submitBtn').disabled = true;

            try {
                // Use GET request with URL parameters to avoid CORS preflight issues
                const params = new URLSearchParams({
                    action: 'submitVote',
                    voter: voterName,
                    skiing: votes.skiing,
                    kyoto: votes.kyoto,
                    kanazawa: votes.kanazawa,
                    hakone: votes.hakone,
                    nikko: votes.nikko,
                    kamakura: votes.kamakura,
                    yokohama: votes.yokohama
                });

                const response = await fetch(SCRIPT_URL + '?' + params.toString());
                const result = await response.json();

                if (result.status === 'success') {
                    showMessage(`Thanks ${voterName}! Your votes have been recorded.`, 'success');
                } else {
                    throw new Error(result.message || 'Unknown error');
                }

            } catch (error) {
                console.error('Error submitting vote:', error);
                showMessage('Error submitting votes. Please check your internet connection and try again.', 'error');
            } finally {
                document.getElementById('loading').classList.remove('active');
                document.getElementById('submitBtn').disabled = false;
            }
        }

        async function showResults() {
            document.getElementById('votingView').style.display = 'none';
            document.getElementById('resultsView').classList.add('active');
            document.getElementById('loadingResults').classList.add('active');
            document.getElementById('results').innerHTML = '';

            // Validate script URL
            if (SCRIPT_URL === 'YOUR_GOOGLE_SCRIPT_URL_HERE') {
                document.getElementById('loadingResults').classList.remove('active');
                document.getElementById('results').innerHTML = '<p class="message error">Google Apps Script URL not configured.</p>';
                return;
            }

            try {
                const response = await fetch(SCRIPT_URL + '?action=getVotes');
                const data = await response.json();

                document.getElementById('loadingResults').classList.remove('active');

                if (!data.votes || data.votes.length === 0) {
                    document.getElementById('results').innerHTML = '<p class="message warning">No votes recorded yet!</p>';
                    return;
                }

                displayResults(data.votes);
                
            } catch (error) {
                console.error('Error fetching results:', error);
                document.getElementById('loadingResults').classList.remove('active');
                document.getElementById('results').innerHTML = '<p class="message error">Error loading results. Please try again.</p>';
            }
        }

        function displayResults(votesData) {
            const resultsContainer = document.getElementById('results');
            resultsContainer.innerHTML = '';

            // Organize votes by activity
            const votesByActivity = {};
            activities.forEach(activity => {
                votesByActivity[activity.id] = {
                    name: activity.name,
                    emojis: activity.emojis,
                    votes: []
                };
            });

            // Parse votes from spreadsheet
            votesData.forEach(row => {
                const voter = row.voter;
                activities.forEach(activity => {
                    if (row[activity.id] !== undefined) {
                        votesByActivity[activity.id].votes.push({
                            voter: voter,
                            score: row[activity.id]
                        });
                    }
                });
            });

            // Display results for each activity
            activities.forEach(activity => {
                const activityData = votesByActivity[activity.id];
                const div = document.createElement('div');
                div.className = 'result-item';

                const h3 = document.createElement('h3');
                h3.textContent = activity.name;
                div.appendChild(h3);

                let totalScore = 0;
                let voteCount = 0;

                activityData.votes.forEach(vote => {
                    const score = Math.min(100, Math.max(0, parseInt(vote.score) || 0));
                    const emojiIndex = Math.floor((score / 100) * (activity.emojis.length - 1));
                    const emoji = activity.emojis[emojiIndex];
                    const color = `hsl(${score * 1.2}, 70%, 50%)`;

                    totalScore += score;
                    voteCount++;

                    const voteBar = document.createElement('div');
                    voteBar.className = 'vote-bar';

                    const voteName = document.createElement('div');
                    voteName.className = 'vote-name';
                    voteName.textContent = vote.voter;

                    const voteVisual = document.createElement('div');
                    voteVisual.className = 'vote-visual';

                    const voteFill = document.createElement('div');
                    voteFill.className = 'vote-fill';
                    voteFill.style.width = score + '%';
                    voteFill.style.background = color;

                    const voteEmoji = document.createElement('div');
                    voteEmoji.className = 'vote-emoji';
                    voteEmoji.textContent = emoji;

                    const voteScore = document.createElement('div');
                    voteScore.className = 'vote-score';
                    voteScore.textContent = score;

                    voteVisual.appendChild(voteFill);
                    voteBar.appendChild(voteName);
                    voteBar.appendChild(voteVisual);
                    voteBar.appendChild(voteEmoji);
                    voteBar.appendChild(voteScore);
                    div.appendChild(voteBar);
                });

                if (voteCount > 0) {
                    const average = Math.round(totalScore / voteCount);
                    const avgDiv = document.createElement('div');
                    avgDiv.className = 'average-score';
                    avgDiv.textContent = `Average: ${average}/100`;
                    div.appendChild(avgDiv);
                }

                resultsContainer.appendChild(div);
            });
        }

        function showVoting() {
            document.getElementById('votingView').style.display = 'block';
            document.getElementById('resultsView').classList.remove('active');
        }

        function showMessage(text, type) {
            const messageDiv = document.getElementById('message');
            const msgElement = document.createElement('div');
            msgElement.className = `message ${type}`;
            msgElement.textContent = text;
            messageDiv.innerHTML = '';
            messageDiv.appendChild(msgElement);
            setTimeout(() => {
                messageDiv.innerHTML = '';
            }, 5000);
        }

        // Initialize on load
        initActivities();
    </script>
</body>
</html>
